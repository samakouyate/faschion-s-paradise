(()=>{var R=Object.defineProperty;var T=(n,t,e)=>t in n?R(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var z=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var O=(n,t,e)=>(T(n,typeof t!="symbol"?t+"":t,e),e),N=(n,t,e)=>{if(!t.has(n))throw TypeError("Cannot "+e)};var s=(n,t,e)=>(N(n,t,"read from private field"),e?e.call(n):t.get(n)),a=(n,t,e)=>{if(t.has(n))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(n):t.set(n,e)};var u=(n,t,e)=>(N(n,t,"access private method"),e);var m=z((X,P)=>{var H=class{constructor(t){this.schema=t}sanitize(t){return this.#t(t,this.schema)}#t(t,e){if(Array.isArray(e))return this.#r(t,e);if(e===String)return t?.toString();if(e===Number)return Number(t);if(e===Boolean)return!["0","false"].includes(t.toString());if(typeof e=="object")return this.#e(t,e);throw new Error(`Don't know how to sanitize ${typeof e} specified in schema`)}#e(t,e){return Object.keys(e).filter(i=>e.hasOwnProperty(i)&&t.hasOwnProperty(i)).reduce((i,r)=>(i[r]=this.#t(t[r],e[r]),i),{})}#r(t,e){if(e.length!==1)throw new Error("Schema arrays must contain exactly one type of field");return t.map(i=>this.#t(i,e[0]))}};P.exports=H});var L=z((V,q)=>{var y=m(),w,f,E,S,p,g,A,d,h,I,v,C,b,o=class{constructor(t){a(this,d);a(this,I);a(this,C);this.token=t,this.debug=!1,this.ready=new Promise((e,i)=>{let r=new XMLHttpRequest;r.open("GET",`${o.PIXEL_HOST}/init`,!0),r.withCredentials=!0,r.onload=e,r.onerror=i,r.send()}),this.ready.then(()=>{let e=new Image;e.src=`${o.PIXEL_HOST}/pixel/sync.gif`})}conf(t){this.token=t}identify(t){return u(this,d,h).call(this,"identify",{userId:t.toString()})}view(){return u(this,d,h).call(this,"view",{url:window.location.href})}lead(t,e,i={}){let r={...i,value:t,currency:e},l=new y(s(o,E));return u(this,d,h).call(this,"lead",l.sanitize(r))}product(t,e,i={}){let r={...i,value:t,currency:e},l=new y(s(o,S));return u(this,d,h).call(this,"product",l.sanitize(r))}addToCart(t,e,i,r={}){let l={...r,value:t,currency:e,quantity:i},M=new y(s(o,p));return u(this,d,h).call(this,"add_to_cart",M.sanitize(l))}checkout(t,e,i={}){let r={...i,value:t,currency:e},l=new y(s(o,g));return u(this,d,h).call(this,"checkout",l.sanitize(r))}code(t,e){return u(this,d,h).call(this,"code",{code:t.toString(),type:e.toString()})}purchase(t,e,i,r={}){let l={...r,value:t,currency:e,id:i},M=new y(s(o,A));return u(this,d,h).call(this,"purchase",M.sanitize(l))}emit(t,...e){if(!!["conf","view","identify","lead","product","addToCart","checkout","code","purchase"].includes(t))return this[t](...e)}},c=o;w=new WeakMap,f=new WeakMap,E=new WeakMap,S=new WeakMap,p=new WeakMap,g=new WeakMap,A=new WeakMap,d=new WeakSet,h=function(t,e){return this.ready.then(()=>{let i={...e,token:this.token,referrer:window.document.referrer};this.debug&&console.log("Sending sanitized payload:",i);let r=new XMLHttpRequest;r.open("POST",`${o.PIXEL_HOST}/${t}`,!0),r.setRequestHeader("Content-Type","application/json"),r.withCredentials=!0,r.onload=u(this,I,v),r.onerror=u(this,C,b),r.send(JSON.stringify(i))})},I=new WeakSet,v=function(){this.debug&&console.log("OK")},C=new WeakSet,b=function(t){this.debug&&console.log("XHR error:",t)},O(c,"PIXEL_HOST","https://mgln.ai"),a(c,w,{value:Number,currency:String}),a(c,f,{productId:String,productName:String,productType:String,productVendor:String,variantId:String,variantName:String}),a(c,E,{...s(o,w),id:String,productId:String,quantity:Number,type:String,category:String}),a(c,S,{...s(o,w),...s(o,f)}),a(c,p,{...s(o,S),quantity:Number}),a(c,g,{...s(o,w),quantity:Number,discountCode:String,id:String,lineItems:[s(o,p)]}),a(c,A,{...s(o,g),isNewCustomer:Boolean});q.exports=c});var x=L();if(window.MAI!==void 0&&Array.isArray(window.MAI.q)){let n=window.MAI.q;window.MAI=new x,n.forEach(t=>{window.MAI.emit(...t)})}else{let n=document.currentScript,t=n.dataset,e=t.hasOwnProperty("token")?t.token:new URL(n.src).searchParams.get("token");window.MAI||(window.MAI=new x(e))}})();
